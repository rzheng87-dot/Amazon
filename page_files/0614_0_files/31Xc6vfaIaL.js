(function(f){var e=window.AmazonUIPageJS||window.P,h=e._namespace||e.attributeErrors,a=h?h("GlowToasterAssets",""):e;a.guardFatal?a.guardFatal(f)(a,window):a.execute(function(){f(a,window)})})(function(f,e,h){f.when("A","a-alert","glow-toaster-action-registry","glow-toaster-overlay","glow-toaster-strings").register("glow-toaster",function(a,g,n,b,c){function l(d){e.ue&&"function"===typeof e.ue.count&&e.ue.count(d,(e.ue.count(d)||0)+1)}function m(){return a.capabilities.mobile?"MOBILE":"DESKTOP"}var k=
a.$;a.on("a:sheet:afterHide:wfm_mweb_qr_bottom_sheet",function(){f.register("QRClosed",function(){})});var p=function(d){this.animationEnabled=!0;this.params=d||{};this.slot="DEFAULT";this.csrfToken="";this.type=h;this.blocking=!1;this.automaticAction=h;this.executeAction={OPEN_GLOW:this.openGlowAutomaticAction};this.FETCH_TOASTER_SUCCESS_METRIC="GLOW:fetch-toaster:"+m()+":success";this.FETCH_TOASTER_FAILURE_METRIC="GLOW:fetch-toaster:"+m()+":failure";this.GLOW_TOASTER_SCOPE="glow-toaster-api-timer-"+
m();this.slots={DEFAULT:a.capabilities.mobile?"#nav-subnav-toaster":"#nav-flyout-iss-anchor",SUBNAV:"#nav-subnav-toaster"};this.selectors={navbar:"#navbar",subnav:"#nav-subnav",toaster:".glow-toaster",actionButton:".glow-toaster-button",actionError:".glow-toaster-error"};this.endpoint="/portal-migration/hz/glow/get-rendered-toaster";this.refreshXhr=h;this.initEvents()};k.extend(p.prototype,{initEvents:function(){a.on("packard:glow:destinationChangeAll",this.handleGlowAddressChange.bind(this));a.on("a:popover:beforeShow",
this.handlePopoverBeforeShow.bind(this));a.on("a:popover:afterHide",this.handlePopoverAfterHide.bind(this));a.on("a:sheet:beforeShow",this.handleSheetBeforeShow.bind(this));a.on("a:sheet:afterHide",this.handleSheetAfterHide.bind(this));a.on.ready(this.handlePageReady.bind(this));k(e).bind("beforeunload",this.handleBeforeUnload.bind(this));k(e).bind("focusin",this.handleFocusIn.bind(this))},refresh:function(){this.ready&&(this.hide(),this.abortRefresh(),"function"===typeof e.uet&&e.uet("bb",this.GLOW_TOASTER_SCOPE,
{wb:1}),this.refreshXhr=a.get(this.endpoint,{params:this.params,cache:!1,success:function(d,a,c){l(this.FETCH_TOASTER_SUCCESS_METRIC);"string"===typeof d&&(this.update(d),"function"===typeof e.uex&&e.uex("ld",this.GLOW_TOASTER_SCOPE,{wb:1}))}.bind(this),error:function(d,a,c){l(this.FETCH_TOASTER_FAILURE_METRIC);e.ueLogError&&e.ueLogError(c,{logLevel:"WARN",attribution:"glow-toaster-refresh-error",message:"Glow toaster load failed with status:"+a})}.bind(this)}))},remove:function(){this.getToasterElement().remove()},
show:function(){!a.capabilities.mobile&&"DEFAULT"==this.slot||!this.animationEnabled?this.getToasterElement().show():this.getToasterElement().slideDown();this.blocking&&b.show();a.capabilities.isAmazonApp&&a.capabilities.ios&&e.scrollTo(0,-999)},hide:function(){!a.capabilities.mobile&&"DEFAULT"==this.slot||!this.animationEnabled?this.getToasterElement().hide():this.getToasterElement().slideUp();this.blocking&&b.hide()},isHidden:function(){return!this.getToasterElement().length||this.getToasterElement().is(":hidden")},
isVisible:function(){return!this.isHidden()},showError:function(d){this.setError(d);this.show()},showErrorID:function(d){d=c.get(d);this.showError(d)},setError:function(d){var a=this.getToasterElement().find(this.selectors.actionError);a=g(a);a.text(d||"");d?a.show():a.hide()},clearError:function(){this.setError("")},isActionFailureEmulated:function(){return/[?&]glowToasterActionEmulateFailure=1(&|$)/.test(location.href)},syncOverlay:function(){this.blocking?b.show():b.hide()},update:function(d){d=
d.trim();var a=!d.length;this.remove();a||(a=k(d).hide(),a.is(this.selectors.toaster)||(a=this.createFatalErrorToaster(d)),this.importProps(a),this.attachActions(a),this.syncOverlay(),this.getContainerElement().append(a),this.show())},createFatalErrorToaster:function(d){var c="glow-toaster glow-toaster-theme-alert glow-toaster-slot-default a-padding-medium",b="";a.capabilities.isAmazonApp?c+=" glow-toaster-app":a.capabilities.mobile||(c+=" nav-coreFlyout nav-flyout",b='\x3cdiv class\x3d"nav-arrow"\x3e\x3cdiv class\x3d"nav-arrow-inner"\x3e\x3c/div\x3e\x3c/div\x3e');
d=k('\x3cdiv class\x3d"'+c+'" data-toaster-slot\x3d"DEFAULT"\x3e\x3cdiv class\x3d"glow-toaster-content"\x3e'+b+'\x3cdiv class\x3d"glow-toaster-body"\x3e'+d+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e");d.hide();return d},getCurrentContainer:function(){return this.slots[this.slot]},getContainerElement:function(){var d=this.getCurrentContainer();return k(d)},getToasterElement:function(){var d=this.getCurrentContainer();return k(d+" "+this.selectors.toaster)},importProps:function(d){d=d.data();d.toasterSlot&&
(this.slot=d.toasterSlot);this.type=d.toasterType||h;this.blocking=!!parseInt(d.toasterBlocking);this.automaticAction=d.toasterAutomaticAction||h;this.csrfToken=d.toasterCsrftoken||d.csrfToken||""},attachActions:function(d){d.bind("click touchstart",this.selectors.actionButton,this.handleActionButtonClick.bind(this));this.automaticAction&&this.executeAction[this.automaticAction]&&this.executeAction[this.automaticAction].call(this)},abortRefresh:function(){this.refreshXhr&&(this.refreshXhr.abort(),
this.refreshXhr=h)},handleActionButtonClick:function(d){k(d.target).is("a")||(d.stopImmediatePropagation(),d.preventDefault());d=k(d.target).data();if(d.actionType){var a=n.getByActionType(d.actionType);a&&("SET_POSTAL_CODE"===d.actionType&&(d.actionParams.zipCode=k("input#glow-toaster-postal-code-input").val()),a.handle(this,d.actionParams))}},handleGlowAddressChange:function(){this.refresh()},handlePopoverBeforeShow:function(a){a=a&&a.popover&&a.popover.type;this.blocking&&"modal"==a&&this.isVisible()&&
b.hide()},handlePopoverAfterHide:function(a){a=a&&a.popover&&a.popover.type;this.blocking&&"modal"==a&&this.isVisible()&&b.show()},handleSheetBeforeShow:function(){this.blocking&&this.isVisible()&&b.hide()},handleSheetAfterHide:function(){this.blocking&&this.isVisible()&&b.show()},handleBeforeUnload:function(){this.abortRefresh()},handlePageReady:function(){this.ready=!0;this.refresh()},handleFocusIn:function(a){if(this.blocking&&b.isVisible()){var c=this.getToasterElement(),d=k(this.selectors.subnav).has(a.target).length,
m=k(this.selectors.navbar).add(this.getContainerElement()).has(a.target).length;a=this.getContainerElement().has(a.target).length;if(d||!m&&!a)c.focus(),b.sync()}},openGlowAutomaticAction:function(){var a=e.location.pathname.includes("storefront"),c=this.openGlow.bind(this),b="GlowToaster:OPEN_GLOW:"+this.type+":"+m()+":";l(b);a?(f.when("A","FMCShowQrCodeTrue","QRClosed").execute(function(){c()}),f.when("A","FMCShowQrCodeFalse").execute(function(){c()})):this.openGlow()},openGlow:function(){var a=
k("#nav-global-location-slot .a-declarative"),c=k("#nav-global-location-slot.a-declarative");a&&a.length?a.click():c&&c.length&&c.click()}});return p});"use strict";f.when("A").register("glow-toaster-string-container",function(a){var g=a.$;a=function(a){this.stringMap=a||{}};g.extend(a.prototype,{get:function(a){return this.stringMap[a]!==h?this.stringMap[a]:""},load:function(a){g.extend(this.stringMap,a)}});return a});"use strict";f.when("glow-toaster-string-container").register("glow-toaster-strings",
function(a){return new a({"glow-toaster-address-change-error":"An address change error has occurred. Please try again.","glow-toaster-unknown-error":"An error has occurred. Please try again."})});"use strict";f.when("A","glow-toaster").register("glow-toaster-manager",function(a,g){var e=function(){};a.$.extend(e.prototype,{toasters:[],create:function(a){a=new g(a);this.toasters.push(a);return a},getAll:function(){return this.toasters}});return new e});"use strict";f.when("A").register("glow-toaster-overlay",
function(a){var g=a.$,f=function(){this.overlayClass="glow-toaster-overlay";this.overlayLockClass="glow-toaster-overlay-lock";this.insertAfterSelector="#nav-subnav-toaster";this.$overlay=h;this.$body=g(document.body);this.animationEnabled=!0};g.extend(f.prototype,{hide:function(){this.$overlay&&(this.$body.removeClass(this.overlayLockClass),this.animationEnabled?this.$overlay.fadeOut():this.$overlay.hide())},show:function(){this.$overlay||(this.createOverlay(),this.initEvents());this.sync();this.$body.addClass(this.overlayLockClass);
this.animationEnabled?this.$overlay.fadeIn():this.$overlay.show()},isVisible:function(){return!!(this.$overlay&&this.$overlay.length&&this.$overlay.is(":visible"))},isHidden:function(){return!this.isVisible()},sync:function(){this.scrollTop();this.syncSize()},scrollTop:function(){g(document).scrollTop(0)},createOverlay:function(){this.$overlay=g("\x3cdiv\x3e").addClass(this.overlayClass).height(0).insertAfter(this.insertAfterSelector);a.capabilities.touch&&this.disableTouch()},disableTouch:function(){this.$overlay.bind("click touchstart",
function(a){a.cancelable&&a.preventDefault()})},initEvents:function(){g(e).bind("resize",this.syncSize.bind(this))},syncSize:function(){if(this.$overlay&&this.$overlay.length){var a=this.getScreenHeight();this.$overlay.height(a);var c=this.getDocumentHeight();c>a&&this.$overlay.height(c)}},getScreenHeight:function(){return g(e).height()},getDocumentHeight:function(){return g(document).height()}});return new f});"use strict";f.when("A","glow-toaster-set-address-action","glow-toaster-select-location-action",
"glow-toaster-dismiss-action","glow-toaster-set-postalcode-action").register("glow-toaster-action-registry",function(a,e,f,b,c){var l=function(a){this.actions=a||[];this.hashActionsByType()};a.$.extend(l.prototype,{getByActionType:function(a){return this.actionsByType[a]},getAll:function(){return this.actions},hashActionsByType:function(){this.actionsByType=a.reduce(this.actions,function(a,c){a[c.name]=c;return a},{})}});return new l([e,f,b,c])});f.when("A").register("glow-toaster-dismiss-toaster-constants",
function(a){return{ENDPOINT:"/portal-migration/hz/glow/dismiss-toaster",PARAMS_FORMAT:"json",CONTENT_TYPE:"application/json"}});f.when("A").register("glow-toaster-select-location-constants",function(a){return{ALM_ADDRESS_INELIGIBLE:"ALM_ADDRESS_INELIGIBLE"}});f.when("A").register("glow-toaster-set-address-constants",function(a){return{ENDPOINT:"/portal-migration/hz/glow/address-change?actionSource\x3dglow-toaster",PARAMS_FORMAT:"json",CONTENT_TYPE:"application/json"}});"use strict";f.when("A","glow-toaster-dismiss-toaster-constants").register("glow-toaster-dismiss-action",
function(a,e){var f=a.$,b=function(){};f.extend(b.prototype,{name:"DISMISS",endpoint:e.ENDPOINT,errorStringID:"glow-toaster-unknown-error",paramsFormat:e.PARAMS_FORMAT,contentType:e.CONTENT_TYPE,skipRefreshToasterTypes:["AEE_AUTO_DETECTED_LOCATION","AIS_EGRESS"],handle:function(c,b){c.hide();b.actionSource="web-"+(a.capabilities.mobile?"mobile":"desktop");a.post(this.endpoint,{params:b,paramsFormat:this.paramsFormat,headers:{"anti-csrftoken-a2z":f(".glow-toaster").attr("data-toaster-csrfToken")||
"","Content-Type":this.contentType},success:function(a,b,e){"object"!==typeof a||!a.success||c.isActionFailureEmulated()?c.showErrorID(this.errorStringID):this.skipRefreshToasterTypes.includes(c.type)||c.refresh()}.bind(this),error:function(a,b,e){c.showErrorID(this.errorStringID)}.bind(this)})}});return new b});"use strict";f.when("A","glow-toaster-select-location-constants").register("glow-toaster-select-location-action",function(a,g){var h=a.$,b=function(){};h.extend(b.prototype,{name:"SELECT_LOCATION",
errorStringID:"glow-toaster-unknown-error",handle:function(a,b){a.type!==g.ALM_ADDRESS_INELIGIBLE&&a.hide();this.showAddressSelector(a,b)},showAddressSelector:function(c,b){a.capabilities.isAmazonApp?this.showAppAddressSelector(c,b):this.showWebAddressSelector(c)},showAppAddressSelector:function(a,b){this.csmLogCount(a);f.when("BottomSheetPlugin").execute(function(a){a.ShowBottomSheet({useCase:"LocUX",paramsInJson:b||{}})})},showWebAddressSelector:function(a){var c=h("#nav-global-location-slot .a-declarative"),
b=h("#nav-global-location-slot.a-declarative"),e=a.isActionFailureEmulated(),f=document.getElementById("nav-global-location-data-modal-action");c.length&&!e?(this.addToasterType(a,f),c.click(),this.csmLogCount(a)):b.length&&!e?(this.addToasterType(a,f),b.click(),this.csmLogCount(a)):(a.showErrorID(this.errorStringID),this.csmLogCount(a,!0))},addToasterType:function(a,b){if(b){var c=b.getAttribute("data-a-modal");if(c)try{c=JSON.parse(c);if(c.url){var e=c.url.includes("?")?"\x26":"?";c.url+=e+"toasterType\x3d"+
(a.type&&""!==a.type?a.type:"UNKNOWN-TOASTER")}b.setAttribute("data-a-modal",JSON.stringify(c))}catch(p){this.csmLogCount(a,!0)}}},csmLogCount:function(a,b){e.ue&&e.ue.count&&(a="GlowToaster:"+(b?"SelectLocationFailed":"SelectLocation")+":"+a.type+":"+this.getDeviceType()+":",e.ue.count(a,1))},getDeviceType:function(){return a.capabilities.isAmazonApp?"APP":a.capabilities.tablet?"TABLET":a.capabilities.mobile?"MOBILE":"DESKTOP"}});return new b});"use strict";f.when("A","glow-toaster-set-address-constants").register("glow-toaster-set-address-action",
function(a,g){var h=function(){};a.$.extend(h.prototype,{name:"SET_ADDRESS",endpoint:g.ENDPOINT,errorStringID:"glow-toaster-address-change-error",forceReload:!0,handle:function(b,c){if(c&&c.addressID){b.hide();var f="generic";b.params&&b.params.storeName&&(f=b.params.storeName);a.post(this.endpoint,{headers:{"anti-csrftoken-a2z":b&&b.csrfToken?b.csrfToken:""},params:{locationType:"ACCOUNT_ADDRESS",addressId:c.addressID,storeContext:f,deviceType:"web",pageType:e.ue_pty,actionSource:"glow-toaster",
toasterType:b.type},paramsFormat:g.PARAMS_FORMAT,contentType:g.CONTENT_TYPE,success:function(a,c,e){"object"!==typeof a||!a.sembuUpdated||b.isActionFailureEmulated()?b.showErrorID(this.errorStringID):this.refreshGlowIngress()}.bind(this),error:function(a,c,e){b.showErrorID(this.errorStringID)}.bind(this)})}},refreshGlowIngress:function(){a.capabilities.isAmazonApp?f.when("BottomSheetPlugin").execute(function(a){a.UpdateGlowIngress({});this.onGlowIngressRefreshComplete()}.bind(this)):(a.trigger("packard:glow:destinationChangeNav"),
this.onGlowIngressRefreshComplete())},onGlowIngressRefreshComplete:function(){this.forceReload?e.location.reload():toaster.refresh()}});return new h});"use strict";f.when("A","glow-toaster-set-address-constants").register("glow-toaster-set-postalcode-action",function(a,g){var n=a.$,b=function(){};n.extend(b.prototype,{name:"SET_POSTAL_CODE",endpoint:g.ENDPOINT,forceReload:!0,handle:function(c,b){b&&null!==b.zipCode&&b.zipCode!==h&&a.post(this.endpoint,{headers:{"anti-csrftoken-a2z":c&&c.csrfToken?
c.csrfToken:""},params:{locationType:"LOCATION_INPUT",zipCode:this.preparePostalCodeForSubmit(b.zipCode),deviceType:"web",pageType:e.ue_pty,actionSource:"glow-toaster",toasterType:c.type},paramsFormat:g.PARAMS_FORMAT,contentType:g.CONTENT_TYPE,success:function(a,e,f){"object"!==typeof a||!a.sembuUpdated||c.isActionFailureEmulated()?(c.showError(b.inputError),n("input#glow-toaster-postal-code-input").addClass("a-form-error")):this.refreshGlowIngress()}.bind(this),error:function(a,e,f){c.showError(b.inputError)}.bind(this)})},
refreshGlowIngress:function(){a.capabilities.isAmazonApp?f.when("BottomSheetPlugin").execute(function(a){a.UpdateGlowIngress({});this.onGlowIngressRefreshComplete()}.bind(this)):(a.trigger("packard:glow:destinationChangeNav"),this.onGlowIngressRefreshComplete())},preparePostalCodeForSubmit:function(a){return a.replace(/[^A-Za-z0-9- /]+/g,"")},onGlowIngressRefreshComplete:function(){this.forceReload?e.location.reload():toaster.refresh()}});return new b})});